<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>uva-library-hours demo</title>

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

    <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
    <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
    <link rel="import" href="../../polymer/lib/elements/dom-bind.html">
    <link rel="import" href="../../polymer/lib/elements/dom-repeat.html">
    <link rel="import" href="../uva-library-hours.html">

    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
      </style>
    </custom-style>
  </head>
  <body>
    <div class="vertical-section-container centered">

      <h3>Basic uva-library-hours</h3>
      <demo-snippet>
        <template>

          <dom-bind id="demo">
            <template>
              <uva-library-hours times="{{times}}"></uva-library-hours>
              <ul>
                <template is="dom-repeat" items="[[toCalList(times)]]" as="cal">
                    <uva-library filter='[[libFilter(cal.id)]]' items="{{cal.libraries}}" sort-by="shortTitle"></uva-library>
                    <li>[[cal.id]]
                      <template is="dom-repeat" items="[[cal.libraries]]" as="lib">
                        <span hidden$="[[!index]]">and</span>
                        [[lib.title]]
                      </template>
                      <span hidden$="[[!cal.libraries.length]]">
                        <br />[[showTodays(cal)]]
                      </span>
                    </li>
                </template>
              </ul>
            </template>
          </dom-bind>

        </template>
      </demo-snippet>

      <script>
        var demo = document.getElementById('demo');
        demo.toCalList = function(o){
          return Object.keys(o).map(k=>Object.assign({id:k},{hours:o[k]}));
        }
        demo.libFilter = function(id){
          return (i)=>i.libcalID==id;//{libcalID:id};
        }
        demo.todaysTimes = function(times){
          return times
        }
        demo.showTodays = function(cal){
          var today;
          return (today = cal.hours[moment().format('YYYY-MM-DD')])? today.rendered: "";
        }
      </script>
    </div>
  </body>
</html>
